<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="description" content="">
    <meta name="author" content="">
    
    <title>Music Queue</title>
    
    <!-- External Scripts and Styles -->
    <script src="https://coolvibes-reloaded.com/ReqForm/ReqQue/script.js"></script>
	<script src="https://coolvibes-reloaded.com/ReqForm/ReqQue/display_fetch.js"></script>
	<script src="https://coolvibes-reloaded.com/ReqForm/ReqQue/fetch.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-app.js"></script>
	<script src="https://www.gstatic.com/firebasejs/8.6.3/firebase-auth.js"></script>
    <link rel="stylesheet" href="https://coolvibes-reloaded.com/ReqForm/ReqQue/style.css">

    <!-- Custom Google Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>

<body>
    <div id="hero">
        <h1>DJ Song Queue</h1>
    </div>  

    <div id="display">
        <div id="loader">
            <h4>Loading</h4>
        </div>
        <div id="allSongs"></div>
        <div id="errorMessage" style="display: none;">
            <h2>Failed to get data. Please refresh</h2>
        </div>
    </div>

    <a href="https://coolvibes-reloaded.com/ReqForm/form.html" target="_blank" style="text-decoration: none; color:white;">Fill out another song request</a>

    <footer>
        <h4>Powered by <a href="https://www.apispreadsheets.com" target="_blank" style="text-decoration: none; color:white;">API Spreadsheets</a></h4>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            let allSongsElm = document.getElementById("allSongs");
            let loaderElm = document.getElementById("loader");
            let errorMessageElm = document.getElementById("errorMessage");

            function setErrorDisplay() {
                loaderElm.style.display = "none";
                allSongsElm.style.display = "none";
                errorMessageElm.style.display = "block";
            }

            // Fetch from first API spreadsheet
            fetch("https://api.apispreadsheets.com/data/7OySATKrFeiUEqMz/")
                .then(res => {
                    if (res.status === 200) {
                        res.json().then(data => {
                            const yourData = data["data"];
                            yourData.forEach(rowInfo => {
                                let rowInfoDiv = document.createElement("div");
                                rowInfoDiv.classList.add("song-row");

                                let rowSong = document.createElement("h2");
                                rowSong.textContent = rowInfo["Song"];
                                rowSong.classList.add("Song");

                                let rowArtist = document.createElement("h4");
                                rowArtist.textContent = rowInfo["Artist"];
                                rowArtist.classList.add("Artist");

                                let rowLink = document.createElement("a");
                                rowLink.setAttribute("href", rowInfo["Link"]);
                                rowLink.setAttribute("target", "_blank");
                                rowLink.textContent = rowInfo["Link"];
                                rowLink.classList.add("Link");

                                rowInfoDiv.appendChild(rowSong);
                                rowInfoDiv.appendChild(rowArtist);
                                rowInfoDiv.appendChild(rowLink);
                                
                                allSongsElm.appendChild(rowInfoDiv);
                            });

                            loaderElm.style.display = "none";
                            allSongsElm.style.display = "block";
                        }).catch(err => {
                            console.error("Error parsing JSON:", err);
                            setErrorDisplay();
                        });
                    } else {
                        setErrorDisplay();
                    }
                }).catch(err => {
                    console.error("Error with fetch:", err);
                    setErrorDisplay();
                });

            // Fetch from second API spreadsheet
            fetch("https://api.apispreadsheets.com/data/7OySATKrFeiUEqMz/")
                .then(res => {
                    if (res.status === 200) {
                        res.json().then(data => {
                            console.log("Second fetch data:", data);
                            // Handle second fetch data here if needed
                        }).catch(err => {
                            console.error("Error parsing second JSON:", err);
                        });
                    } else {
                        console.error("Second fetch failed with status:", res.status);
                    }
                }).catch(err => {
                    console.error("Error with second fetch:", err);
                });
        });
		fetch("https://api.apispreadsheets.com/data/7OySATKrFeiUEqMz/").then(res=>{
    if (res.status === 200){
        // SUCCESS
        res.json().then(data=>{
            const yourData = data
        }).catch(err => console.log(err))
    }
    else{
// ERROR
    </script>
</body>
</html>
